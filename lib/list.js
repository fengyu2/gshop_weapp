"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.List=void 0;var _api2=require("./api.js"),List=exports.List=function(t){var n=this;return this._context=null,this._page=1,this._pageSize=10,this._api="",this._param={},t&&(this._api=t),this.setContext=function(t){return n._context=t,n},this.setParam=function(t,e){return n._param[t]=e,n},this.setApi=function(t){return n._api=t,n},this.getPage=function(){return n._page},this.getDataMap=function(){return{records:[],total:-1,isNew:!0,loading:!1,empty:!1,noMore:!1,noMoreShow:!1}},this.reset=function(t){n._context.setState({records:[],total:-1,isNew:!0,loading:!1,empty:!1,noMore:!1,noMoreShow:!1,page:1},t)},this.fetch=function(t,o){if(t=t||1,n._context.setState({isNew:!1}),!n._context.state.loading&&!n._context.state.noMore){n._context.setState({loading:!0}),n._context.state.loading=!0,1===t&&(n._context.setState({records:[]}),n._context.state.records=[]);var e={};for(var a in e.page=t,e.pageSize=n._pageSize,n._param)e[a]=n._param[a];return _api2.Api.process(n._api,e,function(t){var e={loading:!1};n._page=t.data.page,e.records=n._context.state.records.concat(t.data.records),e.total=t.data.total,t.data.records.length!==n._pageSize&&(e.noMore=!0),e.empty=n._context.state.noMore&&0===n._context.state.records.length,n._context.state.noMore&&!n._context.state.empty?e.noMoreShow=!0:e.noMoreShow=!1,n._context.setState(e),o&&o(n)},function(t){n._context.setState({loading:!1}),_api2.Api.defaultCallback(t)},{loading:!1}),n}},n};